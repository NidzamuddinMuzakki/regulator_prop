(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{1088:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var a=n(1),r=n(508),l=n(1199),o=n.n(l),c=(n(110),function e(){var t=this;Object(r.a)(this,e),this.login=function(e,n){return t.fetch("http://34.101.137.61:22112/credential_service/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:n})}).then(function(e){return t.setToken(e.data),console.log(e.data),e})},this.loggedIn=function(){var e=t.getToken();return!!e&&!t.isTokenExpired(e)},this.isTokenExpired=function(e){try{return o()(e).exp<Date.now()/1e3}catch(t){return console.log("Token expired."),!1}},this.setToken=function(e){localStorage.setItem("id_token",e)},this.getToken=function(){return localStorage.getItem("id_token")},this.logout=function(){localStorage.removeItem("id_token")},this.getConfirm=function(){var e=o()(t.getToken());return console.log("Received answer."),e},this.fetch=function(e,n){var r={Accept:"application/json","Content-Type":"application/json"};return t.loggedIn()&&(r.Authorization="Bearer "+t.getToken()),fetch(e,Object(a.a)({headers:r},n)).then(t._checkStatus).then(function(e){return e.json()})},this._checkStatus=function(e){if(e.status>=200&&e.status<300)return e;var t=new Error(e.statusText);throw t.response=e,t}})},1792:function(e,t,n){"use strict";n.r(t);var a=n(508),r=n(516),l=n(529),o=n(528),c=(n(743),n(0)),i=n.n(c),s=n(112),u=n(9),d=n(1424),h=n(110),p=n(1423),m=n.n(p),f=n(1285),g=n(1290),b=n.n(g),y=n(616),v=n(1291),E=(n(1395),[]),k=[],x=[],w={items:""},j=[];function O(e,t){var n=[];for(var a in e)if(e[a].parent_origin==t&&"false"!=e[a].access_view){var r=O(e,e[a].menu_id);r.length&&""==e[a].url?(e[a].children=r,n.push(e[a])):""!=e[a].url&&n.push(e[a])}return n}var _=function(){var e=Object(v.a)(b.a.mark(function e(){var t,n,a,r,l,o,c;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=localStorage.getItem("id_token"),n={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({key:t,info_data:"all"})},e.prev=2,e.next=5,fetch("http://34.101.137.61:22112/credential_service/get_menu",n);case 5:return a=e.sent,e.next=8,a.json();case 8:r=e.sent,[],r.dataOrigin,w.items=r.dataChanged,E.push(O(r.dataOrigin,"")),k.push({path:"/",exact:!0,name:"Home"}),k.push({path:"/dashboard",name:"Dashboard"}),l=Object(y.a)(r.dataOrigin);try{for(l.s();!(o=l.n()).done;)""!=(c=o.value).url&&"false"!=c.access_view&&(k.push({path:c.url,name:c.name}),x.push(c))}catch(i){l.e(i)}finally{l.f()}return E.push(k),E.push(x),x.push(j),e.abrupt("return",E);case 23:return e.prev=23,e.t0=e.catch(2),e.abrupt("return",e.t0);case 26:case"end":return e.stop()}},e,null,[[2,23]])}));return function(){return e.apply(this,arguments)}}(),R=(n(480),localStorage.getItem("id_token"),n(748)),S=n(1088),T=n(1748),A=n(1807),I=n(749),P=n(1302),z=n.n(P),$=n(1420),C=n.n($),L=function(e){var t=e.treeItems,n=e.create,a=e.update,r=e.delete1,l=e.read;return i.a.createElement(T.a,{style:{height:264,flexGrow:1,maxWidth:400},defaultCollapseIcon:i.a.createElement(z.a,null),defaultExpandIcon:i.a.createElement(C.a,null),defaultEndIcon:i.a.createElement("div",{style:{width:24}})},W(t,n,a,r,l))},N=Object(R.a)(function(e){return{root:{"&:hover > $content":{backgroundColor:"black"},"&:focus > $content, &$selected > $content":{backgroundColor:"black"},"&:focus > $content $label, &:hover > $content $label, &$selected > $content $label":{backgroundColor:"black"}},content:{borderTopRightRadius:e.spacing(2),borderBottomRightRadius:e.spacing(2),paddingRight:e.spacing(1),fontWeight:e.typography.fontWeightMedium,"$expanded > &":{fontWeight:e.typography.fontWeightRegular}},group:{marginLeft:10,borderLeft:"1px dashed white","& $content":{paddingLeft:e.spacing(1),marginLeft:-5}},expanded:{},selected:{},label:{fontWeight:"inherit",color:"inherit"},labelRoot:{display:"flex",alignItems:"center",padding:e.spacing(.5,0)},labelIcon:{marginRight:e.spacing(1)},labelText:{fontWeight:"inherit",flexGrow:1}}});var W=function e(t,n,a,r,l){var o=N();return t.map(function(t){var n=void 0;if(t.children&&t.children.length>0&&(n=e(t.children)),0!=t.length)return i.a.createElement(A.a,{key:t.menu_id,nodeId:t.menu_id,label:i.a.createElement("div",{className:o.labelRoot},""==t.url&&""==t.parent_origin?i.a.createElement(m.a,{className:o.labelIcon}):"",""!=t.url?i.a.createElement(s.b,{style:{textDecoration:"none",color:"white",width:"200%"},to:t.url},i.a.createElement(I.a,{className:o.labelText,variant:"body2"},t.name)):i.a.createElement(I.a,{className:o.labelText,variant:"body2"},t.name)),classes:{root:o.root,content:o.content,expanded:o.expanded,selected:o.selected,group:o.group,label:o.label},children:n})})},D=i.a.lazy(function(){return Promise.all([n.e(2),n.e(4),n.e(10),n.e(20),n.e(33)]).then(n.bind(null,1767))}),M=(i.a.lazy(function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(10),n.e(19)]).then(n.bind(null,1772))}),i.a.lazy(function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(13)]).then(n.bind(null,1801))})),J=i.a.lazy(function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(14)]).then(n.bind(null,1802))}),B=i.a.lazy(function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(15)]).then(n.bind(null,1803))}),G=i.a.lazy(function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(17)]).then(n.bind(null,1804))}),U=i.a.lazy(function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(16)]).then(n.bind(null,1805))}),H=(i.a.lazy(function(){return Promise.all([n.e(0),n.e(1),n.e(3),n.e(26),n.e(28)]).then(n.bind(null,1806))}),i.a.lazy(function(){return Promise.all([n.e(4),n.e(7),n.e(9)]).then(n.bind(null,1764))}),i.a.lazy(function(){return n.e(31).then(n.bind(null,1791))})),Y=i.a.lazy(function(){return n.e(32).then(n.bind(null,1789))}),q=i.a.lazy(function(){return Promise.all([n.e(4),n.e(25)]).then(n.bind(null,1790))}),F=function(e){Object(l.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).Auth=new S.a,r.loading=function(){return i.a.createElement("div",{className:"animated fadeIn pt-1 text-center"},"Loading...")},r._handleLogout=function(){r.Auth.logout(),r.props.history.replace("/login")},r.state={dataRoutes:[],dataAsidemenu:[],dataAccess:[],create:!1,update:!1,read:!1,delete:!1,coba:[]},r}return Object(r.a)(n,[{key:"componentWillMount",value:function(){var e=this;Promise.all([Promise.resolve(_()).then(function(t){return t.length>0?e.setState({dataAsidemenu:t[0],dataRoutes:t[1],dataAccess:t[2],coba:t[3]}):e._handleLogout()})]).then(function(e){console.log(e[0])})}},{key:"componentDidUpdate",value:function(e,t,n){console.log(this.state.dataAsidemenu),console.log(this.state.dataRoutes),console.log(this.state.coba),this.state.dataAccess&&this.props.MenuAccess(this.state.dataAccess)}},{key:"signOut",value:function(e){e.preventDefault(),this.props.history.replace("/login")}},{key:"render",value:function(){return i.a.createElement("div",{className:"app"},i.a.createElement(f.e,{fixed:!0},i.a.createElement(c.Suspense,{fallback:this.loading()},i.a.createElement(q,{onLogout:this._handleLogout}))),i.a.createElement("div",{className:"app-body"},i.a.createElement(f.h,{fixed:!0,display:"lg"},i.a.createElement(f.k,null),i.a.createElement(f.j,null),i.a.createElement(c.Suspense,null,this.state.dataAsidemenu.length>0?i.a.createElement(L,{treeItems:this.state.dataAsidemenu,create:this.state.create,read:this.state.read,delete1:this.state.delete,update:this.state.update}):""),i.a.createElement(f.i,null)),i.a.createElement("main",{className:"main"},i.a.createElement(f.c,{appRoutes:this.state.dataRoutes?this.state.dataRoutes:""}),i.a.createElement(d.a,{fluid:!0},i.a.createElement(c.Suspense,{fallback:this.loading()},this.state.dataRoutes.length>0?i.a.createElement(u.d,null,this.state.dataRoutes?this.state.dataRoutes.map(function(e,t){return i.a.createElement(u.b,{key:t,path:e.path,exact:e.exact},"Dashboard"==e.name?i.a.createElement(D,null):"user"==e.name?i.a.createElement(M,null):"role"==e.name?i.a.createElement(U,null):"group"==e.name?i.a.createElement(B,null):"department"==e.name?i.a.createElement(J,null):"branch"==e.name?i.a.createElement(G,null):i.a.createElement(D,null))}):"",i.a.createElement(u.a,{from:"/",to:"/dashboard"})):""))),i.a.createElement(f.a,{fixed:!0},i.a.createElement(c.Suspense,{fallback:this.loading()},i.a.createElement(H,null)))),i.a.createElement(f.d,null,i.a.createElement(c.Suspense,{fallback:this.loading()},i.a.createElement(Y,null))))}}]),n}(c.Component),K=Object(h.connect)(null,function(e){return{accessuser:function(t,n,a,r){return e({type:"YES",payload:{accesscreate:t,accessview:n,accessupdate:a,accessdelete:r}})},MenuAccess:function(t){return e({type:"MenuAccess",payload:{data:t}})}}})(F);t.default=function(e){var t=new S.a;return function(n){Object(l.a)(s,n);var c=Object(o.a)(s);function s(){var e;Object(a.a)(this,s);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=c.call.apply(c,[this].concat(n))).state={confirm:null,loaded:!1},e}return Object(r.a)(s,[{key:"componentWillMount",value:function(){if(t.loggedIn())try{var e=t.getConfirm();console.log("confirmation is ",e),this.setState({confirm:e,loaded:!0})}catch(n){console.log(n),t.logout(),this.props.history.replace("/login")}else this.props.history.replace("/login")}},{key:"render",value:function(){return!0===this.state.loaded?this.state.confirm?(console.log("confirmed."),i.a.createElement(e,Object.assign({},this.props,{hisotry:this.props.history,confirm:this.state.confirm}))):(console.log("not confirmed."),null):null}}]),s}(c.Component)}(K)},480:function(e,t,n){"use strict";var a=n(1171),r=n.n(a);t.a=r.a.create({baseURL:"http://34.101.137.61:22112/credential_service"})}}]);
//# sourceMappingURL=27.e748f92d.chunk.js.map