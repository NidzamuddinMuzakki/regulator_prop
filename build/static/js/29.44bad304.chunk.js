(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{1103:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var a=n(1),r=n(519),l=n(1205),o=n.n(l),i=(n(110),function e(){var t=this;Object(r.a)(this,e),this.login=function(e,n){return t.fetch("http://34.101.137.61:22112/credential_service/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:n})}).then(function(e){return t.setToken(e.data),console.log(e.data),e})},this.loggedIn=function(){var e=t.getToken();return!!e&&!t.isTokenExpired(e)},this.isTokenExpired=function(e){try{return o()(e).exp<Date.now()/1e3}catch(t){return console.log("Token expired."),!1}},this.setToken=function(e){localStorage.setItem("id_token",e)},this.getToken=function(){return localStorage.getItem("id_token")},this.logout=function(){localStorage.removeItem("id_token")},this.getConfirm=function(){var e=o()(t.getToken());return console.log("Received answer."),e},this.fetch=function(e,n){var r={Accept:"application/json","Content-Type":"application/json"};return t.loggedIn()&&(r.Authorization="Bearer "+t.getToken()),fetch(e,Object(a.a)({headers:r},n)).then(t._checkStatus).then(function(e){return e.json()})},this._checkStatus=function(e){if(e.status>=200&&e.status<300)return e;var t=new Error(e.statusText);throw t.response=e,t}})},1795:function(e,t,n){"use strict";n.r(t);var a=n(519),r=n(597),l=n(602),o=n(601),i=(n(751),n(0)),c=n.n(i),s=n(112),u=n(9),d=n(1429),h=n(110),p=n(1428),m=n.n(p),f=n(1291),g=n(1296),b=n.n(g),y=n(496),v=n(1297),E=(n(1400),[]),k=[],x=[],w={items:""};function O(e,t){var n=[];for(var a in e)if(e[a].parent_origin==t&&"false"!=e[a].access_view){var r=O(e,e[a].menu_id);r.length&&""==e[a].url?(e[a].children=r,n.push(e[a])):""!=e[a].url&&n.push(e[a])}return n}var j=function(){var e=Object(v.a)(b.a.mark(function e(){var t,n,a,r,l,o,i,c;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=localStorage.getItem("id_token"),n={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({key:t,info_data:"all"})},e.prev=2,e.next=5,fetch("http://34.101.137.61:22112/credential_service/get_menu",n);case 5:return a=e.sent,e.next=8,a.json();case 8:r=e.sent,[],r.dataOrigin,w.items=r.dataChanged,E.push(O(r.dataOrigin,"")),O(r.dataOrigin,""),k.push({path:"/",exact:!0,name:"Home"}),k.push({path:"/dashboard",name:"Dashboard"}),l=[],o=Object(y.a)(r.dataOrigin);try{for(o.s();!(i=o.n()).done;)""!=(c=i.value).url&&"false"!=c.access_view&&(k.push({path:c.url,name:c.name}),x.push(c)),""!=c.url&&l.push({Name:c.name,View:"true",Create:"true",Update:"true",Delete:"true"})}catch(s){o.e(s)}finally{o.f()}return E.push(k),E.push(x),E.push(l),e.abrupt("return",E);case 25:return e.prev=25,e.t0=e.catch(2),e.abrupt("return",e.t0);case 28:case"end":return e.stop()}},e,null,[[2,25]])}));return function(){return e.apply(this,arguments)}}(),_=(n(497),localStorage.getItem("id_token"),n(736)),R=n(1103),A=n(1751),S=n(1810),T=n(737),I=n(1308),P=n.n(I),z=n(1425),C=n.n(z),$=function(e){var t=e.treeItems,n=e.create,a=e.update,r=e.delete1,l=e.read;return c.a.createElement(A.a,{style:{height:264,flexGrow:1,maxWidth:400},defaultCollapseIcon:c.a.createElement(P.a,null),defaultExpandIcon:c.a.createElement(C.a,null),defaultEndIcon:c.a.createElement("div",{style:{width:24}})},L(t,n,a,r,l))},N=Object(_.a)(function(e){return{root:{"&:hover > $content":{backgroundColor:"black"},"&:focus > $content, &$selected > $content":{backgroundColor:"black"},"&:focus > $content $label, &:hover > $content $label, &$selected > $content $label":{backgroundColor:"black"}},content:{borderTopRightRadius:e.spacing(2),borderBottomRightRadius:e.spacing(2),paddingRight:e.spacing(1),fontWeight:e.typography.fontWeightMedium,"$expanded > &":{fontWeight:e.typography.fontWeightRegular}},group:{marginLeft:10,borderLeft:"1px dashed white","& $content":{paddingLeft:e.spacing(1),marginLeft:-5}},expanded:{},selected:{},label:{fontWeight:"inherit",color:"inherit"},labelRoot:{display:"flex",alignItems:"center",padding:e.spacing(.5,0)},labelIcon:{marginRight:e.spacing(1)},labelText:{fontWeight:"inherit",flexGrow:1}}});var L=function e(t,n,a,r,l){var o=N();return t.map(function(t){var n=void 0;if(t.children&&t.children.length>0&&(n=e(t.children)),0!=t.length)return c.a.createElement(S.a,{key:t.menu_id,nodeId:t.menu_id,label:c.a.createElement("div",{className:o.labelRoot},""==t.url&&""==t.parent_origin?c.a.createElement(m.a,{className:o.labelIcon}):"",""!=t.url?c.a.createElement(s.b,{style:{textDecoration:"none",color:"white",width:"200%"},to:t.url},c.a.createElement(T.a,{className:o.labelText,variant:"body2"},t.name)):c.a.createElement(T.a,{className:o.labelText,variant:"body2"},t.name)),classes:{root:o.root,content:o.content,expanded:o.expanded,selected:o.selected,group:o.group,label:o.label},children:n})})},M=c.a.lazy(function(){return Promise.all([n.e(2),n.e(4),n.e(10),n.e(21),n.e(34)]).then(n.bind(null,1770))}),W=(c.a.lazy(function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(10),n.e(20)]).then(n.bind(null,1775))}),c.a.lazy(function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(13)]).then(n.bind(null,1804))})),D=c.a.lazy(function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(16)]).then(n.bind(null,1805))}),J=c.a.lazy(function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(17)]).then(n.bind(null,1806))}),U=c.a.lazy(function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(15)]).then(n.bind(null,1807))}),B=c.a.lazy(function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(14)]).then(n.bind(null,1808))}),G=c.a.lazy(function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(18)]).then(n.bind(null,1801))}),H=(c.a.lazy(function(){return Promise.all([n.e(0),n.e(1),n.e(3),n.e(25),n.e(28)]).then(n.bind(null,1809))}),c.a.lazy(function(){return Promise.all([n.e(4),n.e(7),n.e(9)]).then(n.bind(null,1767))}),c.a.lazy(function(){return n.e(32).then(n.bind(null,1794))})),V=c.a.lazy(function(){return n.e(33).then(n.bind(null,1792))}),Y=c.a.lazy(function(){return Promise.all([n.e(4),n.e(27)]).then(n.bind(null,1793))}),q=function(e){Object(l.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).Auth=new R.a,r.loading=function(){return c.a.createElement("div",{className:"animated fadeIn pt-1 text-center"},"Loading...")},r._handleLogout=function(){r.Auth.logout(),r.props.history.replace("/login")},r.state={dataRoutes:[],dataAsidemenu:[],dataAccess:[],create:!1,update:!1,read:!1,delete:!1,coba:[]},r}return Object(r.a)(n,[{key:"componentWillMount",value:function(){var e=this;Promise.resolve(j()).then(function(t){return t.length>0?e.setState({dataAsidemenu:t[0],dataRoutes:t[1],dataAccess:t[2],coba:t[3]}):e._handleLogout()}),console.log(this.state.dataAsidemenu)}},{key:"componentDidUpdate",value:function(e,t,n){console.log(this.state.dataAsidemenu),console.log(this.state.dataRoutes),console.log(this.state.coba),this.state.dataAccess&&(this.props.MenuAccess(this.state.dataAccess),this.props.MenuPilihan(this.state.coba))}},{key:"signOut",value:function(e){e.preventDefault(),this.props.history.replace("/login")}},{key:"render",value:function(){return c.a.createElement("div",{className:"app"},c.a.createElement(f.e,{fixed:!0},c.a.createElement(i.Suspense,{fallback:this.loading()},c.a.createElement(Y,{onLogout:this._handleLogout}))),c.a.createElement("div",{className:"app-body"},c.a.createElement(f.h,{fixed:!0,display:"lg"},c.a.createElement(f.k,null),c.a.createElement(f.j,null),c.a.createElement(i.Suspense,null,this.state.dataAsidemenu.length>0?c.a.createElement($,{treeItems:this.state.dataAsidemenu,create:this.state.create,read:this.state.read,delete1:this.state.delete,update:this.state.update}):""),c.a.createElement(f.i,null)),c.a.createElement("main",{className:"main"},c.a.createElement(f.c,{appRoutes:this.state.dataRoutes?this.state.dataRoutes:""}),c.a.createElement(d.a,{fluid:!0},c.a.createElement(i.Suspense,{fallback:this.loading()},this.state.dataRoutes.length>0?c.a.createElement(u.d,null,this.state.dataRoutes?this.state.dataRoutes.map(function(e,t){return c.a.createElement(u.b,{key:t,path:e.path,exact:e.exact},"Dashboard"==e.name?c.a.createElement(M,null):"user"==e.name?c.a.createElement(W,null):"role"==e.name?c.a.createElement(B,null):"log action"==e.name?c.a.createElement(G,null):"group"==e.name?c.a.createElement(J,null):"department"==e.name?c.a.createElement(D,null):"branch"==e.name?c.a.createElement(U,null):c.a.createElement(M,null))}):"",c.a.createElement(u.a,{from:"/",to:"/dashboard"})):""))),c.a.createElement(f.a,{fixed:!0},c.a.createElement(i.Suspense,{fallback:this.loading()},c.a.createElement(H,null)))),c.a.createElement(f.d,null,c.a.createElement(i.Suspense,{fallback:this.loading()},c.a.createElement(V,null))))}}]),n}(i.Component),F=Object(h.connect)(null,function(e){return{accessuser:function(t,n,a,r){return e({type:"YES",payload:{accesscreate:t,accessview:n,accessupdate:a,accessdelete:r}})},MenuAccess:function(t){return e({type:"MenuAccess",payload:{data:t}})},MenuPilihan:function(t){return e({type:"MenuPilihan",payload:{data:t}})}}})(q);t.default=function(e){var t=new R.a;return function(n){Object(l.a)(s,n);var i=Object(o.a)(s);function s(){var e;Object(a.a)(this,s);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=i.call.apply(i,[this].concat(n))).state={confirm:null,loaded:!1},e}return Object(r.a)(s,[{key:"componentWillMount",value:function(){if(t.loggedIn())try{var e=t.getConfirm();console.log("confirmation is ",e),this.setState({confirm:e,loaded:!0})}catch(n){console.log(n),t.logout(),this.props.history.replace("/login")}else this.props.history.replace("/login")}},{key:"render",value:function(){return!0===this.state.loaded?this.state.confirm?(console.log("confirmed."),c.a.createElement(e,Object.assign({},this.props,{hisotry:this.props.history,confirm:this.state.confirm}))):(console.log("not confirmed."),null):null}}]),s}(i.Component)}(F)},497:function(e,t,n){"use strict";var a=n(1102),r=n.n(a);t.a=r.a.create({baseURL:"http://34.101.137.61:22112/credential_service"})}}]);
//# sourceMappingURL=29.44bad304.chunk.js.map